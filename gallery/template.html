<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FyLinx Gallery</title>

<style>
body{
  margin:0;
  font-family:system-ui, sans-serif;
  background:#111;
  color:#fff;
}

header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 16px;
}

header h1{
  font-size:14px;
  margin:0;
  letter-spacing:1px;
}

button{
  background:#fff;
  color:#000;
  border:0;
  padding:6px 14px;
  font-size:12px;
  cursor:pointer;
}

.gallery{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
  gap:6px;
  padding:8px;
}

.gallery img{
  width:100%;
  height:auto;
  object-fit:contain;
  background:#000;
}

footer{
  text-align:center;
  font-size:11px;
  padding:12px;
  opacity:.5;
}

/* Modal */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.9);
  display:none;
  justify-content:center;
  align-items:center;
}

.modal img{
  max-width:95%;
  max-height:95%;
}
</style>
</head>

<body>

<header>
  <h1>FyLinx</h1>
  <button id="syncBtn">SYNC</button>
</header>

<div class="gallery" id="gallery"></div>

<footer>Â© FyLinx</footer>

<div class="modal" id="modal">
  <img id="modalImg">
</div>

<script>
const API_KEY   = "AIzaSyCyL4jxLN9w87WG20GqeEIAaUCupjKmn8U";
const FOLDER_ID = "1qEfxwXgPcvEPRlBKNNecsHaqFSRrAjTE";
const PAGE_SIZE = 20;

let nextPageToken = null;

async function loadImages(){
  const query = encodeURIComponent(
    `'${FOLDER_ID}' in parents and mimeType contains 'image/'`
  );

  let url =
    `https://www.googleapis.com/drive/v3/files?` +
    `q=${query}` +
    `&orderBy=modifiedTime desc` +
    `&pageSize=${PAGE_SIZE}` +
    `&fields=nextPageToken,files(id,name)` +
    `&key=${API_KEY}`;

  if (nextPageToken) {
    url += `&pageToken=${nextPageToken}`;
  }

  const res = await fetch(url);
  const data = await res.json();

  nextPageToken = data.nextPageToken || null;

  data.files.forEach(file=>{
    const img = document.createElement("img");

    // Thumbnail (fast & public)
    img.src = `https://drive.google.com/thumbnail?id=${file.id}&sz=w1000`;

    // Modal full image
    img.onclick = ()=>openModal(file.id);

    gallery.appendChild(img);
  });
}

function openModal(fileId){
  modalImg.src = `https://lh3.googleusercontent.com/d/${fileId}`;
  modal.style.display = "flex";
}

modal.onclick = ()=> modal.style.display="none";
syncBtn.onclick = loadImages;

// first load
loadImages();
</script>

</body>
</html>
